{% extends 'base.html.twig' %}

{% block title %}Convertir URL en PDF{% endblock %}

{% block body %}

<div class="container_pdf">
    <h1>Convertir URL en PDF</h1>

    {% for message in app.flashes('error') %}
        <div class="alert alert-danger">{{ message }}</div>
    {% endfor %}


{% if app.request.query.get('pdfUrl') %}
<script>
    window.addEventListener('load', () => {
        const pdfUrl = "{{ app.request.query.get('pdfUrl') }}";
        const pdfWindow = window.open(pdfUrl, '_blank');
        if (!pdfWindow || pdfWindow.closed || typeof pdfWindow.closed == 'undefined') { 
            document.getElementById('pdfButton').style.display = 'block';
        }
    });
</script>
{% endif %}
    <form method="post">
            <div class="form-group">
            <label for="title">Titre</label>
            <input type="text" id="title" name="title" class="form-control" placeholder="Entrez un titre" required>
        </div>

        
        <div class="form-group">
            <label for="url">URL</label>
            <input type="text" id="url" name="url" class="form-control" placeholder="Entrez une URL valide" required>
        </div>

        <button type="submit" class="btn btn-primary">Convertir</button>
    </form>

{% if app.request.query.get('pdfUrl') %}

<div id="pdfButton" style="display: none;
                            text-align:center;
                            margin-top:10px;">
    <a href="{{ app.request.query.get('pdfUrl') }}" target="_blank" class="btn btn-primary">Ouvrir le dernier PDF généré </a>
</div>
{% endif %}
</div>
{% endblock %}
